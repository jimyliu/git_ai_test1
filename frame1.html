<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Browser Image Frame Tool 3</title>
<style>
  :root {
    --panel-bg: #ffffff;
    --shadow: 0 8px 24px rgba(0,0,0,0.08);
    --border-radius: 12px;
    --font: -apple-system, BlinkMacSystemFont, "Segoe UI",
            Roboto, Helvetica, Arial, sans-serif;
  }

  body {
    margin: 0;
    font-family: var(--font);
    background: #f5f6f8;
    color: #222;
    display: flex;
    justify-content: center;
    padding: 16px;
  }

  .app {
    max-width: 1100px;
    width: 100%;
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 16px;
  }

  @media (max-width: 900px) {
    .app {
      grid-template-columns: 1fr;
    }
  }

  .panel {
    background: var(--panel-bg);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    padding: 16px;
  }

  h2 {
    font-size: 16px;
    margin: 0 0 12px;
  }

  .group {
    margin-bottom: 14px;
  }

  label {
    font-size: 12px;
    display: block;
    margin-bottom: 4px;
    color: #555;
  }

  input[type="text"],
  input[type="number"] {
    width: 100%;
    padding: 6px 8px;
    font-size: 14px;
    box-sizing: border-box;
  }

  input[type="range"] {
    width: 100%;
  }

  .row {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .row input[type="number"] {
    width: 80px;
  }

  button {
    width: 100%;
    padding: 10px;
    font-size: 14px;
    border: none;
    border-radius: 8px;
    background: #2563eb;
    color: #fff;
    cursor: pointer;
  }

  button.secondary {
    background: #6b7280;
  }

  .canvas-wrap {
    background: var(--panel-bg);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    padding: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: auto;
  }

  canvas {
    max-width: 100%;
    height: auto;
    touch-action: none;
  }

  .hint {
    font-size: 11px;
    color: #777;
    margin-top: 6px;
  }
</style>
</head>
<body>
<div class="app">
  <div class="panel">
    <h2>Image</h2>
    <div class="group">
      <input type="file" accept="image/*" id="imageInput" />
    </div>

    <h2>Frame</h2>
    <div class="group">
      <label>Border Color</label>
      <input type="color" id="borderColor" value="#000000" />
    </div>
    <div class="group">
      <label>Border Thickness</label>
      <div class="row">
        <input type="range" id="borderSize" min="0" max="100" value="20" />
        <input type="number" id="borderSizeNum" min="0" max="100" value="20" />
      </div>
    </div>

    <h2>Title</h2>
    <div class="group">
      <label>Text</label>
      <input type="text" id="titleText" value="Your Title" />
    </div>
    <div class="group">
      <label>Color</label>
      <input type="color" id="titleColor" value="#ffffff" />
    </div>
    <div class="group">
      <label>Size (pt)</label>
      <div class="row">
        <input type="range" id="titleSize" min="14" max="200" value="48" />
        <input type="number" id="titleSizeNum" min="14" max="200" value="48" />
      </div>
    </div>

    <h2>Subtitle</h2>
    <div class="group">
      <label>Text</label>
      <input type="text" id="subtitleText" value="Subtitle here" />
    </div>
    <div class="group">
      <label>Color</label>
      <input type="color" id="subtitleColor" value="#ffffff" />
    </div>
    <div class="group">
      <label>Size (pt)</label>
      <div class="row">
        <input type="range" id="subtitleSize" min="14" max="200" value="24" />
        <input type="number" id="subtitleSizeNum" min="14" max="200" value="24" />
      </div>
    </div>

    <div class="group">
      <button id="randomStyle">Random Style âœ¨</button>
    </div>
    <div class="group">
      <button id="downloadBtn">Download PNG</button>
    </div>
    <div class="hint">Tip: Drag title or subtitle directly on the image</div>
  </div>

  <div class="canvas-wrap">
    <canvas id="canvas"></canvas>
  </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let image = null;

const title = {
  text: "Your Title",
  color: "#ffffff",
  size: 48,
  x: 0,
  y: 0
};

const subtitle = {
  text: "Subtitle here",
  color: "#ffffff",
  size: 24,
  x: 0,
  y: 0
};

let borderColor = "#000000";
let borderSize = 20;

let dragging = null;
let offsetX = 0;
let offsetY = 0;

function autoCenterText() {
  title.x = canvas.width / 2;
  title.y = canvas.height * 0.25;
  subtitle.x = canvas.width / 2;
  subtitle.y = canvas.height * 0.35;
}

function draw() {
  if (!image) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

  if (borderSize > 0) {
    ctx.strokeStyle = borderColor;
    ctx.lineWidth = borderSize;
    ctx.strokeRect(
      borderSize / 2,
      borderSize / 2,
      canvas.width - borderSize,
      canvas.height - borderSize
    );
  }

  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  ctx.fillStyle = title.color;
  ctx.font = `${title.size}px ${getComputedStyle(document.body).fontFamily}`;
  ctx.fillText(title.text, title.x, title.y);

  ctx.fillStyle = subtitle.color;
  ctx.font = `${subtitle.size}px ${getComputedStyle(document.body).fontFamily}`;
  ctx.fillText(subtitle.text, subtitle.x, subtitle.y);
}

document.getElementById("imageInput").addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;
  const img = new Image();
  img.onload = () => {
    image = img;
    canvas.width = img.naturalWidth;
    canvas.height = img.naturalHeight;
    autoCenterText();
    draw();
  };
  img.src = URL.createObjectURL(file);
});

function syncRange(range, number, cb) {
  range.addEventListener("input", () => {
    number.value = range.value;
    cb(parseInt(range.value, 10));
  });
  number.addEventListener("input", () => {
    range.value = number.value;
    cb(parseInt(number.value, 10));
  });
}

syncRange(
  document.getElementById("borderSize"),
  document.getElementById("borderSizeNum"),
  v => { borderSize = v; draw(); }
);

syncRange(
  document.getElementById("titleSize"),
  document.getElementById("titleSizeNum"),
  v => { title.size = v; draw(); }
);

syncRange(
  document.getElementById("subtitleSize"),
  document.getElementById("subtitleSizeNum"),
  v => { subtitle.size = v; draw(); }
);

document.getElementById("borderColor").addEventListener("input", e => {
  borderColor = e.target.value;
  draw();
});

document.getElementById("titleText").addEventListener("input", e => {
  title.text = e.target.value;
  draw();
});

document.getElementById("titleColor").addEventListener("input", e => {
  title.color = e.target.value;
  draw();
});

document.getElementById("subtitleText").addEventListener("input", e => {
  subtitle.text = e.target.value;
  draw();
});

document.getElementById("subtitleColor").addEventListener("input", e => {
  subtitle.color = e.target.value;
  draw();
});

function hitTestText(obj, x, y) {
  ctx.font = `${obj.size}px ${getComputedStyle(document.body).fontFamily}`;
  const w = ctx.measureText(obj.text).width;
  const h = obj.size;
  return (
    x >= obj.x - w / 2 &&
    x <= obj.x + w / 2 &&
    y >= obj.y - h / 2 &&
    y <= obj.y + h / 2
  );
}

function pointerDown(x, y) {
  if (hitTestText(title, x, y)) {
    dragging = title;
  } else if (hitTestText(subtitle, x, y)) {
    dragging = subtitle;
  }
  if (dragging) {
    offsetX = x - dragging.x;
    offsetY = y - dragging.y;
  }
}

function pointerMove(x, y) {
  if (!dragging) return;
  dragging.x = x - offsetX;
  dragging.y = y - offsetY;
  draw();
}

function pointerUp() {
  dragging = null;
}

canvas.addEventListener("mousedown", e => {
  const r = canvas.getBoundingClientRect();
  pointerDown(
    (e.clientX - r.left) * (canvas.width / r.width),
    (e.clientY - r.top) * (canvas.height / r.height)
  );
});

canvas.addEventListener("mousemove", e => {
  const r = canvas.getBoundingClientRect();
  pointerMove(
    (e.clientX - r.left) * (canvas.width / r.width),
    (e.clientY - r.top) * (canvas.height / r.height)
  );
});

window.addEventListener("mouseup", pointerUp);

canvas.addEventListener("touchstart", e => {
  const t = e.touches[0];
  const r = canvas.getBoundingClientRect();
  pointerDown(
    (t.clientX - r.left) * (canvas.width / r.width),
    (t.clientY - r.top) * (canvas.height / r.height)
  );
});

canvas.addEventListener("touchmove", e => {
  const t = e.touches[0];
  const r = canvas.getBoundingClientRect();
  pointerMove(
    (t.clientX - r.left) * (canvas.width / r.width),
    (t.clientY - r.top) * (canvas.height / r.height)
  );
});

canvas.addEventListener("touchend", pointerUp);

document.getElementById("downloadBtn").addEventListener("click", () => {
  if (!image) return;
  const a = document.createElement("a");
  a.download = "framed-image.png";
  a.href = canvas.toDataURL("image/png");
  a.click();
});

document.getElementById("randomStyle").addEventListener("click", () => {
  const colors = ["#ffffff", "#facc15", "#38bdf8", "#f472b6"];
  title.color = colors[Math.floor(Math.random() * colors.length)];
  subtitle.color = colors[Math.floor(Math.random() * colors.length)];
  borderColor = colors[Math.floor(Math.random() * colors.length)];
  borderSize = Math.floor(Math.random() * 40) + 10;
  document.getElementById("borderSize").value = borderSize;
  document.getElementById("borderSizeNum").value = borderSize;
  autoCenterText();
  draw();
});
</script>
</body>
</html>
