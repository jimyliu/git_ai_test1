<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Browser Image Frame Tool 2</title>

<style>
  :root {
    --bg: #f4f6f8;
    --panel: #ffffff;
    --accent: #2563eb;
    --text: #1f2937;
    --shadow: 0 8px 20px rgba(0,0,0,0.08);
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont,
      "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  header {
    padding: 16px 24px;
    font-size: 18px;
    font-weight: 600;
  }

  main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 16px;
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 20px;
  }

  @media (max-width: 900px) {
    main { grid-template-columns: 1fr; }
  }

  .canvas-wrapper {
    background: var(--panel);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 16px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  canvas {
    max-width: 100%;
    height: auto;
    cursor: grab;
  }

  .controls {
    background: var(--panel);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  h3 {
    margin: 8px 0 4px;
    font-size: 14px;
    font-weight: 600;
  }

  label {
    font-size: 12px;
    display: block;
    margin-bottom: 2px;
  }

  input[type="text"] {
    width: 100%;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #d1d5db;
    font-size: 14px;
  }

  input[type="range"] { width: 100%; }

  input[type="color"] {
    width: 42px;
    height: 28px;
    border: none;
    padding: 0;
    background: none;
  }

  .row {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  button {
    padding: 10px;
    border-radius: 8px;
    border: none;
    font-size: 14px;
    cursor: pointer;
    background: var(--accent);
    color: #fff;
    font-weight: 500;
  }

  button.secondary {
    background: #6b7280;
  }

  .hint {
    font-size: 12px;
    color: #6b7280;
    line-height: 1.4;
  }
</style>
</head>

<body>

<header>üñºÔ∏è Browser-Only Image Frame Tool</header>

<main>
  <div class="canvas-wrapper">
    <canvas id="canvas"></canvas>
  </div>

  <div class="controls">
    <h3>Image</h3>
    <input type="file" id="imageInput" accept="image/*"/>

    <h3>Frame Border</h3>
    <div class="row">
      <label>Color</label>
      <input type="color" id="frameColor" value="#000000"/>
      <label>Thickness</label>
    </div>
    <input type="range" id="frameThickness" min="0" max="80" value="20"/>

    <h3>Title</h3>
    <input type="text" id="titleText" placeholder="Title text"/>
    <div class="row">
      <label>Color</label><input type="color" id="titleColor" value="#ffffff"/>
      <label>Size</label>
    </div>
    <input type="range" id="titleSize" min="14" max="72" value="36"/>

    <h3>Subtitle</h3>
    <input type="text" id="subtitleText" placeholder="Subtitle text"/>
    <div class="row">
      <label>Color</label><input type="color" id="subtitleColor" value="#ffffff"/>
      <label>Size</label>
    </div>
    <input type="range" id="subtitleSize" min="14" max="72" value="20"/>

    <h3>Export</h3>
    <button id="downloadBtn">Download PNG</button>

    <div class="hint">
      ‚Ä¢ Drag title / subtitle to move<br/>
      ‚Ä¢ Image ratio always preserved<br/>
      ‚Ä¢ Border thickness is equal on all sides<br/>
      ‚Ä¢ Chrome & Safari compatible
    </div>
  </div>
</main>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let img = null;
let dragging = null;

const title = { text: "", x: 0.5, y: 0.15, size: 36, color: "#ffffff" };
const subtitle = { text: "", x: 0.5, y: 0.25, size: 20, color: "#ffffff" };

let frameColor = "#000000";
let frameThickness = 20;

function resizeCanvasByImage(image) {
  const maxWidth = 900;
  const ratio = image.width / image.height;
  const width = Math.min(maxWidth, image.width);
  const height = width / ratio;
  canvas.width = width;
  canvas.height = height;
}

function draw() {
  if (!img) {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    return;
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

  if (frameThickness > 0) {
    ctx.strokeStyle = frameColor;
    ctx.lineWidth = frameThickness;
    ctx.strokeRect(
      frameThickness / 2,
      frameThickness / 2,
      canvas.width - frameThickness,
      canvas.height - frameThickness
    );
  }

  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  ctx.fillStyle = title.color;
  ctx.font = `${title.size}px sans-serif`;
  ctx.fillText(title.text, canvas.width * title.x, canvas.height * title.y);

  ctx.fillStyle = subtitle.color;
  ctx.font = `${subtitle.size}px sans-serif`;
  ctx.fillText(subtitle.text, canvas.width * subtitle.x, canvas.height * subtitle.y);
}

document.getElementById("imageInput").addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  const image = new Image();
  image.onload = () => {
    img = image;
    resizeCanvasByImage(image);
    draw();
  };
  image.src = URL.createObjectURL(file);
});

function bindInput(id, target, prop) {
  document.getElementById(id).addEventListener("input", e => {
    target[prop] = e.target.type === "range"
      ? Number(e.target.value)
      : e.target.value;
    draw();
  });
}

bindInput("titleText", title, "text");
bindInput("titleSize", title, "size");
bindInput("titleColor", title, "color");

bindInput("subtitleText", subtitle, "text");
bindInput("subtitleSize", subtitle, "size");
bindInput("subtitleColor", subtitle, "color");

document.getElementById("frameColor").addEventListener("input", e => {
  frameColor = e.target.value;
  draw();
});

document.getElementById("frameThickness").addEventListener("input", e => {
  frameThickness = Number(e.target.value);
  draw();
});

function getPointerPos(evt) {
  const rect = canvas.getBoundingClientRect();
  const x = (evt.clientX - rect.left) / canvas.width;
  const y = (evt.clientY - rect.top) / canvas.height;
  return { x, y };
}

canvas.addEventListener("mousedown", e => {
  const p = getPointerPos(e);
  if (Math.abs(p.y - title.y) < 0.05) dragging = title;
  else if (Math.abs(p.y - subtitle.y) < 0.05) dragging = subtitle;
});

canvas.addEventListener("mousemove", e => {
  if (!dragging) return;
  const p = getPointerPos(e);
  dragging.x = p.x;
  dragging.y = p.y;
  draw();
});

window.addEventListener("mouseup", () => dragging = null);

/* Safari & mobile touch support */
canvas.addEventListener("touchstart", e => {
  const t = e.touches[0];
  const p = getPointerPos(t);
  if (Math.abs(p.y - title.y) < 0.05) dragging = title;
  else if (Math.abs(p.y - subtitle.y) < 0.05) dragging = subtitle;
});

canvas.addEventListener("touchmove", e => {
  if (!dragging) return;
  const t = e.touches[0];
  const p = getPointerPos(t);
  dragging.x = p.x;
  dragging.y = p.y;
  draw();
  e.preventDefault();
}, { passive: false });

window.addEventListener("touchend", () => dragging = null);

document.getElementById("downloadBtn").addEventListener("click", () => {
  const a = document.createElement("a");
  a.download = "framed-image.png";
  a.href = canvas.toDataURL("image/png");
  a.click();
});
</script>

</body>
</html>
